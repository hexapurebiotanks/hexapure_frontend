import{j as e,r as m,R as O,u as ie,a as ce}from"./index-k1TN58Z3.js";import{updateDoc as H,doc as M,deleteDoc as P,query as J,orderBy as G,collection as K,onSnapshot as W}from"./index.esm-C-nIvyYm.js";import{db as D}from"./config-CIyxAiC8.js";import{C as de}from"./Close-juwxlB_d.js";import{c as w}from"./createSvgIcon-BMKys1ie.js";import{E as me}from"./Email-Bqj7_-lP.js";import{C as xe}from"./CheckCircle-BUx0dJ8q.js";import"./index.esm-CcvhtTQJ.js";import"./index.esm-s6jmi4tn.js";import"./index.esm-B6i4C4xO.js";const q=w(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),ue=w(e.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),he=w(e.jsx("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"})),pe=w(e.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"})),ge=w(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M7 13.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m5 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m5 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"})),fe=w(e.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"})),_=w(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"})),R=({title:n,value:r,subText:l,icon:c,colorClass:o})=>e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md flex justify-between items-start hover:shadow-lg transition-shadow duration-300",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 font-medium mb-1 text-sm",children:n}),e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-0.5",children:r}),e.jsx("p",{className:`text-sm ${o} font-medium`,children:l})]}),e.jsx("div",{className:`p-3 rounded-xl ${o.replace("text-","bg-")} bg-opacity-10`,children:c})]}),be=({activeTab:n,contacts:r,users:l,searchQuery:c})=>{const[o,i]=m.useState(r),[x,g]=m.useState(l),[N,b]=m.useState(!1),[C,y]=m.useState(!1),[d,v]=m.useState(null),[u,f]=m.useState(null),[T,L]=m.useState(null),[h,k]=m.useState({name:"",email:"",role:"user",status:"active"}),[p,V]=m.useState({fromDate:"",toDate:""}),X=t=>{if(t.length===0){alert("No data to export");return}const a=[["Name","Email","Company","Phone","Subject","Message","Status","Date"].join(","),...t.map(j=>[`"${j.name||""}"`,`"${j.email||""}"`,`"${j.company||""}"`,`"${j.phone||""}"`,`"${j.subject||""}"`,`"${j.message||""}"`,`"${j.status||""}"`,`"${j.date||""}"`].join(","))].join(`
`),A=new Blob([a],{type:"text/csv;charset=utf-8;"}),S=document.createElement("a"),oe=URL.createObjectURL(A);S.setAttribute("href",oe),S.setAttribute("download",`enquiries_export_${new Date().toISOString().split("T")[0]}.csv`),S.style.visibility="hidden",document.body.appendChild(S),S.click(),document.body.removeChild(S)};O.useEffect(()=>{i(r)},[r]),O.useEffect(()=>{g(l)},[l]);const Z=async(t,s)=>{try{i(a=>a.map(A=>A.id===t?{...A,status:s}:A)),await H(M(D,"contacts",t),{status:s,updatedAt:new Date})}catch(a){console.error("Error updating status:",a),i(r)}},U=t=>t.role!=="admin"?!0:x.filter(a=>a.role==="admin").length>1,Q=t=>{v(t),k({name:t.name,email:t.email,role:t.role,status:t.status}),b(!0),L(null)},ee=t=>{f({type:"user",item:t}),y(!0),L(null)},te=t=>{f({type:"contact",item:t}),y(!0)},se=async()=>{y(!1);const t=u;f(null);try{t.type==="user"?(g(s=>s.filter(a=>a.id!==t.item.id)),await P(M(D,"users",t.item.id))):t.type==="contact"&&(i(s=>s.filter(a=>a.id!==t.item.id)),await P(M(D,"contacts",t.item.id)))}catch(s){console.error("Error deleting item:",s),t.type==="user"?g(a=>[...a,t.item]):t.type==="contact"&&i(a=>[...a,t.item])}},ae=async t=>{t.preventDefault();try{await H(M(D,"users",d.id),{name:h.name,email:h.email,role:h.role,status:h.status,updatedAt:new Date}),g(s=>s.map(a=>a.id===d.id?{...a,...h}:a)),b(!1),v(null)}catch(s){console.error("Error updating user:",s)}},re=t=>{L(T===t?null:t)};O.useEffect(()=>{const t=s=>{T&&!s.target.closest(".dropdown-container")&&L(null)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[T]);const B=t=>{const s={new:{color:"bg-blue-100 text-blue-800",label:"New"},contacted:{color:"bg-yellow-100 text-yellow-800",label:"Contacted"},pending:{color:"bg-orange-100 text-orange-800",label:"Pending"},resolved:{color:"bg-green-100 text-green-800",label:"Resolved"},active:{color:"bg-green-100 text-green-800",label:"Active"},inactive:{color:"bg-red-100 text-red-800",label:"Inactive"}},a=s[t]||s.new;return e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${a.color}`,children:a.label})},ne=t=>{const s={admin:{color:"bg-purple-100 text-purple-800",label:"Admin"},user:{color:"bg-gray-100 text-gray-800",label:"User"},moderator:{color:"bg-blue-100 text-blue-800",label:"Moderator"}},a=s[t]||s.user;return e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${a.color}`,children:a.label})},$=o.filter(t=>{if(c){const s=c.toLowerCase();if(!(t.name?.toLowerCase().includes(s)||t.email?.toLowerCase().includes(s)||t.company?.toLowerCase().includes(s)||t.status?.toLowerCase().includes(s)))return!1}if(p.fromDate||p.toDate){const s=new Date(t.createdAt?.toDate?.()||t.createdAt);if(isNaN(s.getTime()))return!0;if(p.fromDate){const a=new Date(p.fromDate);if(s<a)return!1}if(p.toDate){const a=new Date(p.toDate);if(a.setHours(23,59,59,999),s>a)return!1}}return!0}),F=x.filter(t=>{if(!c)return!0;const s=c.toLowerCase();return t.name?.toLowerCase().includes(s)||t.email?.toLowerCase().includes(s)||t.role?.toLowerCase().includes(s)}),le=()=>n==="registrations"?e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800",children:["New Enquires (",$.length,c||p.fromDate||p.toDate?` of ${o.length}`:"",")"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"From:"}),e.jsx("input",{type:"date",value:p.fromDate,onChange:t=>V({...p,fromDate:t.target.value}),className:"border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"To:"}),e.jsx("input",{type:"date",value:p.toDate,onChange:t=>V({...p,toDate:t.target.value}),className:"border border-gray-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("button",{onClick:()=>X($),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm font-medium flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export CSV"]})]})]})}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-100",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:[e.jsx("th",{className:"px-6 py-3 text-left",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Company"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Subject"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:$.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:t.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:t.company}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:t.subject}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:t.date}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:B(t.status)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("select",{value:t.status,onChange:s=>Z(t.id,s.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-indigo-500 mr-2",children:[e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"resolved",children:"Resolved"})]}),e.jsx("button",{onClick:()=>te(t),className:"text-red-600 hover:text-red-800 p-1 rounded",title:"Delete enquiry",children:e.jsx(q,{className:"w-4 h-4"})})]})]},t.id))})]}),o.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No contact Enquires found"})]})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 p-6 border-b",children:["User Management (",F.length,c?` of ${x.length}`:"",")"]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-100",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:[e.jsx("th",{className:"px-6 py-3 text-left",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Registration Date"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Last Login"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:F.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:t.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ne(t.role)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:B(t.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:t.createdAt?.split("T")[0]||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:t.lastLogin||"Never"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 relative",children:e.jsxs("div",{className:"relative dropdown-container",children:[e.jsx("button",{onClick:()=>re(t.id),className:"p-1 rounded hover:bg-gray-200",title:"More actions",children:e.jsx(pe,{className:"w-4 h-4"})}),T===t.id&&e.jsxs("div",{className:"absolute right-0 mt-1 w-32 bg-white border border-gray-200 rounded-md shadow-lg z-10 dropdown-container",children:[e.jsxs("button",{onClick:()=>Q(t),className:"flex items-center w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Edit"]}),e.jsxs("button",{onClick:()=>ee(t),disabled:!U(t),className:`flex items-center w-full px-3 py-2 text-sm hover:bg-gray-100 ${U(t)?"text-red-600 hover:bg-red-50":"text-gray-400 cursor-not-allowed"}`,children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})})]},t.id))})]}),x.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No users found"})]})]});return e.jsxs(e.Fragment,{children:[le(),N&&d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Edit User"}),e.jsx("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(de,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:ae,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:h.name,onChange:t=>k({...h,name:t.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:h.email,onChange:t=>k({...h,email:t.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:h.role,onChange:t=>k({...h,role:t.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"moderator",children:"Moderator"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:h.status,onChange:t=>k({...h,status:t.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>b(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Save Changes"})]})]})]})}),C&&u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(q,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Confirmation"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete this ",u.type,"?"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"bg-gray-50 rounded p-3",children:u.type==="user"?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:u.item.name}),e.jsx("p",{className:"text-sm text-gray-600",children:u.item.email}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Role: ",u.item.role]})]}):e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:u.item.name}),e.jsx("p",{className:"text-sm text-gray-600",children:u.item.email}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Subject: ",u.item.subject]})]})}),u.type==="user"&&!U(u.item)&&e.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded",children:e.jsx("p",{className:"text-sm text-yellow-800",children:"⚠️ Cannot delete the last admin user. At least one admin must remain."})})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:se,disabled:u.type==="user"&&!U(u.item),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete"})]})]})})]})},ye=({searchQuery:n,onSearchChange:r})=>{const{currentUser:l,logout:c}=ie(),o=ce(),[i,x]=m.useState(!1),g=m.useRef(null),N=m.useRef(null),b=l?.displayName?l.displayName.split(" ").map(d=>d[0]).join("").toUpperCase():"AD",C=()=>{x(d=>!d)},y=async()=>{try{await c(),x(!1),o("/admin/login")}catch(d){console.error("Failed to log out:",d)}};return m.useEffect(()=>{const d=v=>{g.current&&!g.current.contains(v.target)&&N.current&&!N.current.contains(v.target)&&x(!1)};return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 flex justify-between items-center h-16 px-4 sm:px-6 bg-white shadow-sm border-b",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:"/.netlify/images?url=/images/hexapure_logo.png&w=200&fm=webp",alt:"Company Logo",className:"h-8 w-auto",loading:"eager",width:"200",height:"40",onError:d=>{d.target.style.display="none",d.target.nextSibling.style.display="block"}}),e.jsx("div",{className:"hidden bg-indigo-600 text-white font-bold text-lg px-3 py-1 rounded",children:"LOGO"})]}),e.jsxs("div",{className:"hidden md:block relative w-72 mx-4",children:[e.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search",value:n,onChange:d=>r(d.target.value),className:"w-full py-2 pl-10 pr-4 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsx("div",{className:"flex items-center space-x-3 sm:space-x-6",children:e.jsxs("div",{className:"relative",children:[e.jsxs("button",{ref:N,onClick:C,className:"flex items-center space-x-1 sm:space-x-2 cursor-pointer focus:outline-none",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full overflow-hidden bg-gradient-to-r from-indigo-500 to-purple-600 flex items-center justify-center text-white font-semibold text-xs sm:text-sm",children:b}),e.jsx("span",{className:"hidden sm:block text-sm font-medium text-gray-700",children:l?.displayName||"Admin User"})]}),i&&e.jsxs("div",{ref:g,className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 ring-1 ring-black ring-opacity-5 z-50",children:[e.jsx("div",{className:"px-4 py-2 text-sm text-gray-700 border-b border-gray-100 truncate",children:l?.email||"admin@example.com"}),e.jsxs("button",{onClick:y,className:"w-full text-left flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 hover:text-red-700 transition duration-150",children:[e.jsx(he,{className:"mr-3 h-4 w-4"}),"Sign Out"]})]})]})})]}),e.jsx("div",{className:"fixed top-16 left-0 right-0 z-40 md:hidden bg-white border-b px-4 py-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search...",value:n,onChange:d=>r(d.target.value),className:"w-full py-2 pl-10 pr-4 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})})]})},je=300*1e3,E={CONTACTS:"cached_contacts",USERS:"cached_users",STATS:"cached_stats"},z=n=>{try{const r=localStorage.getItem(n);if(!r)return null;const{data:l,timestamp:c}=JSON.parse(r);return Date.now()-c>je?(localStorage.removeItem(n),null):l}catch(r){return console.error("Error reading cache:",r),null}},I=(n,r)=>{try{const l={data:r,timestamp:Date.now()};localStorage.setItem(n,JSON.stringify(l))}catch(l){console.error("Error setting cache:",l)}},Y=n=>{const r=z(E.CONTACTS);r&&n(r);const l=J(K(D,"contacts"),G("createdAt","desc"));return W(l,c=>{const o=[];c.forEach(i=>{o.push({id:i.id,...i.data(),date:i.data().createdAt?.toDate?.().toISOString().split("T")[0]||"N/A"})}),I(E.CONTACTS,o),n(o)})},Ne=n=>{const r=z(E.USERS);r&&n(r);const l=J(K(D,"users"),G("createdAt","desc"));return W(l,c=>{const o=[];c.forEach(i=>{o.push({id:i.id,...i.data()})}),I(E.USERS,o),n(o)})},ve=n=>{const r=z(E.STATS);return r&&n(r),Y(c=>{const o=we(c);I(E.STATS,o),n(o)})},we=n=>{const r=n.length,l=n.filter(i=>i.status==="new").length,c=n.filter(i=>i.status==="contacted"||i.status==="resolved").length,o=n.filter(i=>i.status==="pending").length;return{totalUsers:r,newRegistrations:l,contacted:c,pending:o}},Re=()=>{const[n,r]=m.useState("registrations"),[l,c]=m.useState([]),[o,i]=m.useState([]),[x,g]=m.useState({totalUsers:0,newRegistrations:0,contacted:0,pending:0}),[N,b]=m.useState(!0),[C,y]=m.useState("");return m.useEffect(()=>{const d=Y(f=>{c(f),b(!1)}),v=Ne(f=>{i(f)}),u=ve(f=>{g(f)});return()=>{d(),v(),u()}},[]),N?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#2E8B57] mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ye,{searchQuery:C,onSearchChange:y}),e.jsxs("main",{className:"pt-16 p-4 sm:p-6 mt-9 md:p-8",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 md:gap-6 mb-6 sm:mb-8 mt-12 md:mt-6 lg:mt-6",children:[e.jsx(R,{title:"Total Enquires",value:x.totalUsers.toString(),subText:"From contact forms",icon:e.jsx(fe,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600"}),colorClass:"text-purple-600"}),e.jsx(R,{title:"New Enquires",value:x.newRegistrations.toString(),subText:"Require attention",icon:e.jsx(me,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-600"}),colorClass:"text-green-600"}),e.jsx(R,{title:"Contacted Enquires",value:x.contacted.toString(),subText:`${x.totalUsers?Math.round(x.contacted/x.totalUsers*100):0}% of total`,icon:e.jsx(xe,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"}),colorClass:"text-blue-600"}),e.jsx(R,{title:"Pending Enquires",value:x.pending.toString(),subText:"Need follow-up",icon:e.jsx(ge,{className:"w-5 h-5 sm:w-6 sm:h-6 text-pink-600"}),colorClass:"text-pink-600"})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>r("registrations"),className:`whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm ${n==="registrations"?"border-[#2E8B57] text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Enquires (",l.length,")"]}),e.jsxs("button",{onClick:()=>r("users"),className:`whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm ${n==="users"?"border-[#2E8B57] text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["User Management (",o.length,")"]})]})})}),e.jsx(be,{activeTab:n,contacts:l,users:o,searchQuery:C})]})]})};export{Re as default};
