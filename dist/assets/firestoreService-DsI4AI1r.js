const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/config-olvm9fE5.js","assets/index.esm-DkvNeMuJ.js","assets/index.esm-D0dmCHGp.js","assets/index.esm-BV1k-qkD.js"])))=>i.map(i=>d[i]);
import{_ as d}from"./index-Yqfij8K6.js";import{addDoc as g,collection as u,serverTimestamp as m,query as h,orderBy as T,onSnapshot as _}from"./index.esm-BV1k-qkD.js";const A=300*1e3,c={CONTACTS:"cached_contacts",USERS:"cached_users",STATS:"cached_stats"},S=e=>{try{const t=localStorage.getItem(e);if(!t)return null;const{data:s,timestamp:a}=JSON.parse(t);return Date.now()-a>A?(localStorage.removeItem(e),null):s}catch(t){return console.error("Error reading cache:",t),null}},l=(e,t)=>{try{const s={data:t,timestamp:Date.now()};localStorage.setItem(e,JSON.stringify(s))}catch(s){console.error("Error setting cache:",s)}},w=async e=>{try{const{initFirebase:t}=await d(async()=>{const{initFirebase:o}=await import("./config-olvm9fE5.js");return{initFirebase:o}},__vite__mapDeps([0,1,2,3])),{db:s}=t(),a=await g(u(s,"contacts"),{...e,createdAt:m(),status:"new"});return console.log("Registration saved with ID: ",a.id),localStorage.removeItem(c.CONTACTS),localStorage.removeItem(c.STATS),a.id}catch(t){throw console.error("Error while registering: ",t),t}},C=async e=>{const t=S(c.CONTACTS);t&&e(t);const{initFirebase:s}=await d(async()=>{const{initFirebase:r}=await import("./config-olvm9fE5.js");return{initFirebase:r}},__vite__mapDeps([0,1,2,3])),{db:a}=s(),o=h(u(a,"contacts"),T("createdAt","desc"));return _(o,r=>{const n=[];r.forEach(i=>{n.push({id:i.id,...i.data(),date:i.data().createdAt?.toDate?.().toISOString().split("T")[0]||"N/A"})}),l(c.CONTACTS,n),e(n)})},f=async e=>{const t=S(c.USERS);t&&e(t);const{initFirebase:s}=await d(async()=>{const{initFirebase:r}=await import("./config-olvm9fE5.js");return{initFirebase:r}},__vite__mapDeps([0,1,2,3])),{db:a}=s(),o=h(u(a,"users"),T("createdAt","desc"));return _(o,r=>{const n=[];r.forEach(i=>{n.push({id:i.id,...i.data()})}),l(c.USERS,n),e(n)})},y=async e=>{const t=S(c.STATS);return t&&e(t),await C(a=>{const o=b(a);l(c.STATS,o),e(o)})},b=e=>{const t=e.length,s=e.filter(r=>r.status==="new").length,a=e.filter(r=>r.status==="contacted"||r.status==="resolved").length,o=e.filter(r=>r.status==="pending").length;return{totalUsers:t,newRegistrations:s,contacted:a,pending:o}};export{w as a,f as b,y as c,C as s};
